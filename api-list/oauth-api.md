# OAuth2 API

The OAuth2 APi is responsible for handling authentication
to the LOS API. All API requests must be accompanied by
a valid token generated by this API in order to prove that
the request is from a client application that has been
registered with EDR.

The authentication protocol is described in detail in
the [Authentication](../authentication.md) section of
this document.

## Available API Endpoints

The following endpoints are available in this API subsystem:

### <span style="background-color: #ebb747; font-weight: bold; color: #ffffff; padding: 3px 10px; border-radius: 14px;">POST</span> **OAuth2 Access Token**

{Deprecated}
```text
/api/v1.1/oauth/token
```

```text
/api/v1.1/oauth/token
```

This endpoint is accessible via the HTTP `POST` method. It
is responsible for authenticating supplied credentials and
issuing a time-limited access token. This token must then
be provided with every subsequent API request.

Note that this API endpoint **does not** conform to the typical
API request and response structures for the LOS API. This
endpoint instead provides a simpler interface, since it is
meant to be invoked before any other tasks are performed via
the API.

#### Request

##### Path Parameters

This endpoint does not accept and URL path parameters.

##### Body Parameters

This endpoint accepts the following JSON-encoded parameters
as top-level attributes:

| Request Parameter | Required | Type | Description |
| :--- | :--- | :--- | :--- |
| grant_type | Yes | String | The constant string `"client_credentials"` (no other authorization grant is currently supported). |
| client_id | Yes | String | Your client ID (provided to you by EDR). This will be a UUID. |
| client_secret | Yes | String | Your secret key (provided to you by EDR). |
| scope | Yes | String | The constant string `"*"` (a single asterisk). |

##### Example JSON Request

A valid request to this endpoint would be structured as follows
(replacing the client ID and secret key with your actual values,
as appropriate):

```json
{
  "grant_type": "client_credentials",
  "client_id": "EXAMPLE_CLIENT_ID",
  "client_secret": "EXAMPLE_SECRET_KEY",
  "scope": "*"
}
```

#### Response

##### Expected HTTP Response Code

When operating normally, this API endpoint will return
an HTTP response code of `200` ("OK").

##### Body Parameters

If the supplied credentials are valid and an access token
is successfully generated, then the API response will
contain the following parameters in its top-level `data`
element:

| Request Parameter | Type | Description |
| :--- | :--- | :--- |
| token_type | String | The type of token. Currently this will always be "Bearer" (representing an OAuth2 bearer token). |
| expires_in | Integer | The number of seconds until the access token expires. |
| access_token | String | The access token. |

##### Example JSON Response

Assuming a successful invocation of this endpoint, an OAuth2
bearer token will be generated in a response similar to the
following:

```json
{
  "meta": {
    "date": "2018-06-17T22:18:45Z",
    "function": "oauth",
    "responseCode": 200,
    "responseID": "22e4122c-798e-11e8-adc0-fa7ae01bbebc",
    "success": true
  },
  "data": {
    "token_type": "Bearer",
    "expires_in": 3600,
    "access_token": "EXAMPLE_ACCESS_TOKEN"
  }
}

```
